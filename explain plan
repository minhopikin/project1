WITH indexed_data AS (explain update
	membership.ram_member_eligibility e
where
	e.plan_name = 'UHCKS')
set
	(medicaid_id ,
	alternate_id ,
	payment_alternate_id ,
	medicare_no ,
	date_of_birth ,
	first_name ,
	last_name ,
	member_name_prefix ,
	gender ,
	social_sec_no ,
	employee_no) = (demo.medicaid_id,
	demo.alternate_id,
	demo.payment_alternate_id,
	demo.medicare_no,
	demo.date_of_birth,
	demo.first_name,
	demo.last_name,
	demo.mem_name_prefix,
	demo.gender,
	demo.social_sec_no,
	demo.employee_no )
from
	membership.ram_member_demographics demo
join membership.ram_eligibility_file_data file_data on
	demo.subscriber_id = file_data.subscriber_id and demo.plan_name  = file_data.plan_name
where
	e.plan_name = 'UHCKS'
	and e.subscriber_id = demo.subscriber_id
	and e.plan_name = demo.plan_name
	and (demo.first_name,
		demo.last_name,
		demo.mem_name_prefix,
		demo.DATE_OF_BIRTH,
		demo.GENDER,
		demo.social_sec_no,
		demo.employee_no,
		demo.medicaid_id,
		demo.alternate_id,
		demo.medicare_no  
            ) <> (
		e.first_name,
		e.last_name,
		e.member_name_prefix,
		e.DATE_OF_BIRTH,
		e.GENDER,
		e.social_sec_no,
		e.employee_no,
		e.medicaid_id,
		e.alternate_id,
		e.medicare_no) ;
