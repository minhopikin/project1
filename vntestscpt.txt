EXPLAIN ANALYZE WITH temp_table AS (  
  SELECT plan_name, ROW_NUMBER() OVER () AS row_number  
  FROM payment.ram_temp_humana_combined  
  ORDER BY plan_name  
)  
UPDATE payment.ram_temp_humana_combined AS t  
SET SEQ_HUMANA_ID = tt.row_number  
FROM temp_table AS tt  
WHERE t.plan_name = tt.plan_name;

-- Assuming plan_name is unique or part of a unique key
WITH RankedTable AS (
  SELECT 
    t1.plan_name, 
    COUNT(t2.plan_name) AS row_number
  FROM 
    payment.ram_temp_humana_combined t1
  LEFT JOIN 
    payment.ram_temp_humana_combined t2 ON t1.plan_name >= t2.plan_name
  GROUP BY 
    t1.plan_name
)
UPDATE t
SET SEQ_HUMANA_ID = rt.row_number
FROM payment.ram_temp_humana_combined AS t
JOIN RankedTable AS rt ON t.plan_name = rt.plan_name;
